Important notes
- Extract reads using the whole genome, not particular genes.
- Perform genotyping on reads using all of their respective genes.  If reads that map to A, B, C are extracted, then A, B, C genes are used for genotyping.



To run HISAT-genotype
   ./hisat2_test_HLA_genotyping.py --aligner-list hisat2.graph --hla-list A --simulate-interval 10 --perbase-errorrate 0.3 --perbase-snprate 0.1 --num-editdist 2 --debug paired --skip-fragment-regions 1000-1020

   ./hisat2_test_HLA_genotyping.py --aligner-list hisat2.graph --hla-list A --simulate-interval 10 --perbase-errorrate 0.3 --perbase-snprate 0.1 --num-editdist 2 --debug paired,full --random-seed 0

   ./hisat2_test_HLA_genotyping.py --aligner-list hisat2.graph --hla-list A --simulate-interval 10 --debug paired,full --no-assembly



HISAT-genotype vs. Omixon

   ./hisat2_test_HLA_genotyping.py --aligner-list hisat2.graph --hla-list A --num-editdist 2 --reads CP_80/LP6005106-DNA_H02.extracted.fq.1.gz,CP_80/LP6005106-DNA_H02.extracted.fq.2.gz --display-alleles A*23:17,A*02:02:01:01

HISAT-genotye on Illumina Platinum Genomes
   ./hisat2_test_HLA_genotyping.py --aligner-list hisat2.graph --hla-list A --num-editdist 2 --reads illumina/NA12892.fished_1.fq,illumina/NA12892.fished_2.fq
   
   ./hisat2_test_HLA_genotyping.py --aligner-list hisat2.graph --hla-list A --num-editdist 2 --reads ILMN_A/NA12892.extracted.1.fq.gz,ILMN_A/NA12892.extracted.2.fq.gz --display-alleles A*02:01:01:01,A*11:01:01:01

   ./hisat2_test_HLA_genotyping.py --aligner-list hisat2.graph --hla-list A --num-editdist 2 --reads ILMN_12062016/NA12892.extracted.1.fq.gz,ILMN_12062016/NA12892.extracted.2.fq.gz

   for i in `ls -l ILMN/NA128*1.fq.gz | awk '{print $NF}' | cut -d'/' -f2 | cut -d'.' -f1`; do echo $i; ./hisat2_test_HLA_genotyping.py --hla-list A --aligner-list hisat2.graph --num-editdist 2 --reads ILMN/$i.extracted.1.fq.gz,ILMN/$i.extracted.2.fq.gz --assembly-base assembly_graph_$i 2> $i.tmp; done

   for i in `ls -l CP_80/LP*1.fq.gz | awk '{print $NF}' | cut -d'/' -f2 | cut -d'.' -f1`; do echo $i; ./hisat2_test_HLA_genotyping.py --hla-list A --aligner-list hisat2.graph --num-editdist 2 --reads CP_80/$i.extracted.1.fq.gz,CP_80/$i.extracted.2.fq.gz --assembly-base assembly_graph_$i 2> $i.tmp; done

   scripts/hisat2_test_HLA_genotyping_CP.py CP_80 -p 4 --num-editdist 2 > cp_80_hla.txt
   scripts/compare_HLA_Omixon.py cp_80_hla.txt ../CAAPA/omixon_caapa_hla.txt 


Stranded-seq
   ./hisat2_test_HLA_genotyping.py --hla-list A --aligner-list hisat2.graph --num-editdist 2 --reads ILMN/NA12892.extracted.1.fq.gz,ILMN/NA12892.extracted.2.fq.gz --stranded-seq NA12892,ILMN_StrandSeq/SraRunInfo.txt


To extract HLA alleles and variants

   ./hisatgenotype_extract_vars.py --hla-list A --inter-gap 30 --intra-gap 50
   ./hisatgenotype_extract_vars.py --hla-list A --inter-gap 30 --intra-gap 50 --min-var-freq 0.1

To build genotype genome

   ./hisatgenotype_build_genome.py genome.fa genotype_genome -p 3 --verbose

To extract reads that may have originated from HLA genes
   scripts/extract_reads.py --base-fname genotype_genome --reference-type genome --read-dir ILMN_12062016 --out-dir ILMN

To genotype

   ./hisatgenotype.py --base-name genotype_6 -f -1 1.fa -2 2.fa


HISAT2 alignment
   ../../../hisat2 --no-hd -x genotype_genome -c CAGCTGGGATGTGGAGTGGTGTGAGGAGTGGCCACAGGGGAGCAGAGGAGGTGGCAGAAGCCGGAGGTAAAGGTGTCTTAAA


On MARCC - https://www.marcc.jhu.edu/getting-started/basic

sbatch script-name
squeue -u dkim136@jhu.edu
scancel job-id
sinfo

